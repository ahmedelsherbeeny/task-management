"use strict";(self.webpackChunktask_managment=self.webpackChunktask_managment||[]).push([[592],{4217:(E,g,t)=>{t.d(g,{b:()=>m});var n=t(7398),d=t(5592),i=t(4664),p=t(2096),o=t(2572),u=t(7142),c=t(5879),l=t(891);let m=(()=>{class _{constructor(e){this.firestore=e}getManagers(){return this.firestore.collection("users",e=>e.where("role","==","manager")).snapshotChanges().pipe((0,n.U)(e=>e.map(a=>{const r=a.payload.doc.data();return{id:a.payload.doc.id,...r}})))}getCurrentManager(e){return this.firestore.collection("users").doc(e).valueChanges()}addUserToManager(e,a){return new d.y(r=>{this.firestore.collection("users").doc(a).get().subscribe({next:s=>{if(s.exists){const f=s.data().managedUsers||[];f.includes(e)||f.push(e),this.firestore.collection("users").doc(a).update({managedUsers:f}).then(()=>this.firestore.collection("users").doc(e).update({hasManager:!0})).then(()=>{r.next({message:"User successfully assigned to manager"}),r.complete()}).catch(h=>{r.error(h)})}else r.error("Manager not found")},error:s=>{r.error(s)}})})}removeManagerFromUser(e,a){return new d.y(r=>{this.firestore.collection("users").doc(e).update({managedUsers:u.Z.firestore.FieldValue.arrayRemove(a)}).then(()=>{r.next(),r.complete()}).catch(s=>{r.error(s)})})}fetchManagedUsers(e){return this.firestore.collection("users").doc(e).get().pipe((0,i.w)(a=>{if(a.exists){const s=a.data().managedUsers||[];if(0===s.length)return(0,p.of)([]);const M=s.map(f=>this.firestore.collection("users").doc(f).get().pipe((0,n.U)(h=>({id:h.id,...h.data()}))));return(0,o.a)(M)}return(0,p.of)([])}))}static#t=this.\u0275fac=function(a){return new(a||_)(c.LFG(l.ST))};static#e=this.\u0275prov=c.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"})}return _})()},9185:(E,g,t)=>{t.d(g,{R:()=>d});var n=t(5879);let d=(()=>{class i{static#t=this.\u0275fac=function(u){return new(u||i)};static#e=this.\u0275cmp=n.Xpm({type:i,selectors:[["app-loader"]],decls:2,vars:0,consts:[[1,"loading-overlay"],[1,"loading-spinner"]],template:function(u,c){1&u&&(n.TgZ(0,"div",0),n._UZ(1,"div",1),n.qZA())},styles:[".loading-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(215,223,223,.8);display:flex;align-items:center;justify-content:center;z-index:9999}.loading-spinner[_ngcontent-%COMP%]{border:10px solid #f3f3f3;border-top:10px solid #3498db;border-radius:50%;width:81px;height:81px;animation:_ngcontent-ng-c1761210088_spin 2s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"]})}return i})()},9372:(E,g,t)=>{t.d(g,{K:()=>p});var n=t(7398),d=t(5879),i=t(891);let p=(()=>{class o{constructor(c){this.firestore=c}getUsers(){return this.firestore.collection("users").snapshotChanges().pipe((0,n.U)(c=>c.map(l=>{const m=l.payload.doc.data();return{id:l.payload.doc.id,...m}})))}static#t=this.\u0275fac=function(l){return new(l||o)(d.LFG(i.ST))};static#e=this.\u0275prov=d.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})()}}]);