"use strict";(self.webpackChunktask_managment=self.webpackChunktask_managment||[]).push([[47],{2047:(B,g,i)=>{i.r(g),i.d(g,{ManagerModule:()=>Y});var d=i(6814),u=i(8948),n=i(6223),t=i(5879),p=i(5790),f=i(4217),h=i(9372),k=i(6697),T=i(3354),v=i(9185);function Z(e,l){1&e&&t._UZ(0,"app-loader")}function _(e,l){1&e&&(t.TgZ(0,"div",19),t._uU(1," Title is required. "),t.qZA())}function C(e,l){1&e&&(t.TgZ(0,"div",19),t._uU(1," Created By is required. "),t.qZA())}function M(e,l){1&e&&(t.TgZ(0,"div",19),t._uU(1," Description is required. "),t.qZA())}let b=(()=>{class e{constructor(a,s,r,o,c,m,N){this.fb=a,this.taskService=s,this.managerService=r,this.router=o,this.userService=c,this.modal=m,this.message=N,this.isEditMode=!1,this.users=[],this.Loader=!1,this.userService.getUsers().subscribe(D=>{this.users=D.filter(q=>"user"===q.role)})}ngOnInit(){this.fetchCurrentManager(),this.initTaskForm(),this.taskId=this.taskData?.data.id,this.isEditMode=!!this.taskId,this.isEditMode&&this.taskService.getTask(this.taskId).subscribe(a=>{this.taskForm.patchValue(a)})}fetchCurrentManager(){const a=localStorage.getItem("userUUID");a?this.managerService.getCurrentManager(a).subscribe({next:s=>{this.currentManager=s,this.taskForm.controls.createdBy.patchValue(this.currentManager.userName)},error:s=>{this.message.toast(s,"error")}}):this.message.toast("Manager ID not found in localStorage","error")}initTaskForm(){this.taskForm=this.fb.group({assignedTo:["Not Assigned Yet"],createdBy:["",n.kI.required],title:["",n.kI.required],description:["",n.kI.required],status:["To Do"]})}onSubmit(){if(this.taskForm.valid){this.Loader=!0;const a={...this.taskForm.getRawValue()};this.isEditMode?this.taskService.updateTask(this.taskId,a).subscribe(()=>{this.Loader=!1,this.modal.close(),this.message.toast("Updated Successfully","success"),this.router.navigate(["/manager/task-management"])},s=>{this.message.toast(s,"error")}):this.taskService.createTask(a).subscribe(()=>{this.Loader=!1,this.modal.close(),this.message.toast("Created Successfully","success"),this.router.navigate(["/manager/task-management"])},s=>{this.message.toast(s,"error")})}}static#t=this.\u0275fac=function(s){return new(s||e)(t.Y36(n.qu),t.Y36(p.M),t.Y36(f.b),t.Y36(u.F0),t.Y36(h.K),t.Y36(k.Kz),t.Y36(T.e))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-task"]],inputs:{taskData:"taskData"},decls:34,vars:8,consts:[[1,"container","pb-2","pt-2"],[4,"ngIf"],[1,"header","d-flex","justify-content-between","mt-2"],["type","button","aria-label","Close",1,"btn-close","btn-sm",3,"click"],[3,"formGroup","ngSubmit"],[1,"form-group"],["for","title",1,"mb-1"],["id","title","type","text","formControlName","title",1,"form-control"],["class","text-danger",4,"ngIf"],["for","createdBy",1,"mb-1"],["id","createdBy","type","text","formControlName","createdBy",1,"form-control"],["for","description",1,"mb-1"],["id","description","formControlName","description",1,"form-control"],["for","status",1,"mb-1"],["id","status","formControlName","status",1,"form-control"],["value","To Do"],["value","In Progress"],["value","Done"],["type","submit",1,"btn","btn-primary","mt-2",3,"disabled"],[1,"text-danger"]],template:function(s,r){if(1&s&&(t.TgZ(0,"div",0),t.YNc(1,Z,1,0,"app-loader",1),t.TgZ(2,"div",2)(3,"h2"),t._uU(4),t.qZA(),t.TgZ(5,"button",3),t.NdJ("click",function(){return r.modal.dismiss()}),t.qZA()(),t.TgZ(6,"form",4),t.NdJ("ngSubmit",function(){return r.onSubmit()}),t.TgZ(7,"div",5)(8,"label",6),t._uU(9,"Title"),t.qZA(),t._UZ(10,"input",7),t.YNc(11,_,2,0,"div",8),t.qZA(),t.TgZ(12,"div",5)(13,"label",9),t._uU(14,"Created By"),t.qZA(),t._UZ(15,"input",10),t.YNc(16,C,2,0,"div",8),t.qZA(),t.TgZ(17,"div",5)(18,"label",11),t._uU(19,"Description"),t.qZA(),t._UZ(20,"textarea",12),t.YNc(21,M,2,0,"div",8),t.qZA(),t.TgZ(22,"div",5)(23,"label",13),t._uU(24,"Status"),t.qZA(),t.TgZ(25,"select",14)(26,"option",15),t._uU(27,"To Do"),t.qZA(),t.TgZ(28,"option",16),t._uU(29,"In Progress"),t.qZA(),t.TgZ(30,"option",17),t._uU(31,"Done"),t.qZA()()(),t.TgZ(32,"button",18),t._uU(33),t.qZA()()()),2&s){let o,c,m;t.xp6(1),t.Q6J("ngIf",r.Loader),t.xp6(3),t.Oqu(r.isEditMode?"Edit Task":"Create Task"),t.xp6(2),t.Q6J("formGroup",r.taskForm),t.xp6(5),t.Q6J("ngIf",(null==(o=r.taskForm.get("title"))?null:o.invalid)&&(null==(o=r.taskForm.get("title"))?null:o.touched)),t.xp6(5),t.Q6J("ngIf",(null==(c=r.taskForm.get("createdBy"))?null:c.invalid)&&(null==(c=r.taskForm.get("createdBy"))?null:c.touched)),t.xp6(5),t.Q6J("ngIf",(null==(m=r.taskForm.get("description"))?null:m.invalid)&&(null==(m=r.taskForm.get("description"))?null:m.touched)),t.xp6(11),t.Q6J("disabled",!r.taskForm.valid),t.xp6(1),t.hij(" ",r.isEditMode?"Update Task":"Create Task"," ")}},dependencies:[d.O5,n._Y,n.YN,n.Kr,n.Fj,n.EJ,n.JJ,n.JL,n.sg,n.u,v.R]})}return e})();var S=i(6828);function U(e,l){1&e&&t._UZ(0,"app-loader")}function I(e,l){if(1&e){const a=t.EpF();t.TgZ(0,"button",7),t.NdJ("click",function(){t.CHM(a);const r=t.oxw();return t.KtG(r.openCreateTaskModa())}),t._uU(1," Create Task "),t.qZA()}}function y(e,l){1&e&&(t.TgZ(0,"div",8),t._uU(1," No tasks found. "),t.qZA())}function F(e,l){if(1&e){const a=t.EpF();t.TgZ(0,"app-task-card",9),t.NdJ("emitTaskData",function(r){t.CHM(a);const o=t.oxw();return t.KtG(o.editTask(r))}),t.qZA()}if(2&e){const a=l.$implicit,s=t.oxw();t.Q6J("task",a)("users",s.users)}}const A=[{path:"task-management",component:(()=>{class e{constructor(a,s,r,o,c){this.modalService=a,this.taskService=s,this.userService=r,this.managerService=o,this.message=c,this.tasks=[],this.users=[],this.onlyUsers=[],this.Loader=!1}ngOnInit(){this.userRole=JSON.parse(JSON.stringify(localStorage.getItem("userRole"))),this.fetchTasks(),this.fetchManagedUsers()}fetchTasks(){this.Loader=!0,this.taskService.getAllTasks().subscribe(a=>{this.tasks=a,this.Loader=!1},a=>{this.Loader=!1,this.message.toast(a,"error")})}fetchManagedUsers(){if("admin"!==this.userRole){const a=localStorage.getItem("userUUID");a&&this.managerService.fetchManagedUsers(a).subscribe({next:s=>{this.users=s},error:s=>{console.error("Error fetching managed users:",s)}})}else this.userService.getUsers().subscribe(a=>{this.users=a.filter(s=>"user"==s.role)})}openCreateTaskModa(){this.modalRef=this.modalService.open(b,{backdrop:"static",size:"lg",centered:!0,modalDialogClass:"task-preview",backdropClass:"modal-backdrop-preview"})}editTask(a){this.modalRef=this.modalService.open(b,{backdrop:"static",size:"lg",centered:!0,modalDialogClass:"task-preview",backdropClass:"modal-backdrop-preview"}),this.modalRef.componentInstance.taskData={data:a.taskData,edit:!0}}static#t=this.\u0275fac=function(s){return new(s||e)(t.Y36(k.FF),t.Y36(p.M),t.Y36(h.K),t.Y36(f.b),t.Y36(T.e))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-task-management"]],decls:8,vars:4,consts:[[1,"container","d-flex","justify-content-center","align-items-center","flex-column","mb-4"],[4,"ngIf"],[1,"text-center","mt-2"],["class","btn btn-primary mt-2 text-center",3,"click",4,"ngIf"],[1,"container","d-flex","justify-content-center","flex-wrap","align-items-center","gap-3","mt-2"],["class","alert alert-info",4,"ngIf"],[3,"task","users","emitTaskData",4,"ngFor","ngForOf"],[1,"btn","btn-primary","mt-2","text-center",3,"click"],[1,"alert","alert-info"],[3,"task","users","emitTaskData"]],template:function(s,r){1&s&&(t.TgZ(0,"div",0),t.YNc(1,U,1,0,"app-loader",1),t.TgZ(2,"h2",2),t._uU(3,"Task Management"),t.qZA(),t.YNc(4,I,2,0,"button",3),t.qZA(),t.TgZ(5,"div",4),t.YNc(6,y,2,0,"div",5),t.YNc(7,F,1,2,"app-task-card",6),t.qZA()),2&s&&(t.xp6(1),t.Q6J("ngIf",r.Loader),t.xp6(3),t.Q6J("ngIf","manager"===r.userRole),t.xp6(2),t.Q6J("ngIf",0===r.tasks.length),t.xp6(1),t.Q6J("ngForOf",r.tasks))},dependencies:[d.sg,d.O5,S.J,v.R]})}return e})()}];let x=(()=>{class e{static#t=this.\u0275fac=function(s){return new(s||e)};static#e=this.\u0275mod=t.oAB({type:e});static#s=this.\u0275inj=t.cJS({imports:[u.Bz.forChild(A),u.Bz]})}return e})();var J=i(6208);let Y=(()=>{class e{static#t=this.\u0275fac=function(s){return new(s||e)};static#e=this.\u0275mod=t.oAB({type:e});static#s=this.\u0275inj=t.cJS({imports:[d.ez,x,n.u5,n.UX,J.m]})}return e})()}}]);